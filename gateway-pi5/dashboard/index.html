<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DC Monitor Mesh Dashboard</title>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- D3.js and Chart.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Dashboard Style -->
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <header id="header">
        <h1>DC Monitor Mesh Gateway</h1>
        <div id="connection-badge" class="badge disconnected">‚óè Disconnected</div>
    </header>

    <main id="main-grid">
        <section id="topology-section" class="panel">
            <h2>Mesh Topology</h2>
            <svg id="mesh-graph"></svg>
        </section>

        <aside id="pm-panel" class="panel">
            <h2>Power Manager</h2>
            <div id="pm-content">
                <div class="stat-row">
                    <span>Status:</span> <span id="pm-active" class="badge">Inactive</span>
                </div>
                <div class="stat-row">
                    <span>Threshold:</span> <span id="pm-threshold">--</span>
                </div>
                <div class="stat-row">
                    <span>Budget (90%):</span> <span id="pm-budget">--</span>
                </div>
                <div class="stat-row">
                    <span>Total Power:</span> <span id="pm-total">--</span>
                </div>
                <div class="stat-row">
                    <span>Priority Node:</span> <span id="pm-priority">None</span>
                </div>
            </div>
        </aside>

        <section id="nodes-section">
            <h2>Nodes</h2>
            <div id="node-cards"><!-- JS populated --></div>
        </section>

        <section id="history-section" class="panel">
            <h2>History</h2>
            <div id="time-controls">
                <button class="time-btn active" data-minutes="5">5m</button>
                <button class="time-btn" data-minutes="30">30m</button>
                <button class="time-btn" data-minutes="60">1h</button>
                <button class="time-btn" data-minutes="1440">24h</button>
            </div>
            <div class="chart-container">
                <canvas id="power-chart"></canvas>
            </div>
        </section>

        <section id="console-section" class="panel">
            <h2>Console</h2>
            <div id="console-log"></div>
            <input id="console-input" type="text" placeholder="Enter command (e.g., node 0 r) and press Enter...">
        </section>
    </main>

    <footer id="status-bar">
        <span id="node-summary">0 sensing, 0 relays</span>
        <span id="ws-status">WebSocket: Connecting...</span>
    </footer>

    <!-- Modules -->
    <script type="module" src="/js/app.js"></script>
</body>
</html>
